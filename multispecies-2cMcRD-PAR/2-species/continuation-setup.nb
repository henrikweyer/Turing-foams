(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102404,       2316]
NotebookOptionsPosition[     97183,       2220]
NotebookOutlinePosition[     97576,       2236]
CellTagsIndexPosition[     97533,       2233]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
MIT License

Copyright (c) 2020 Fridtjof Brauns

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the \
\[OpenCurlyDoubleQuote]Software\[CloseCurlyDoubleQuote]), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED \[OpenCurlyDoubleQuote]AS \
IS\[CloseCurlyDoubleQuote], WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.\
\>", "Text",
 CellChangeTimes->{
  3.9308065867578783`*^9},ExpressionUUID->"60f7483d-969d-4f48-aa14-\
760057194c1e"],

Cell["\<\
Code implementing pseudo-arclength continuation, cf. B. Fiedler, Handbook of \
Dynamical Systems. Vol. 2 (North Holland, 2002)
Code by Fridtjof Brauns: https://github.com/f-brauns/2cMcRD-coarsening\
\>", "Text",
 CellChangeTimes->{{3.922433043171729*^9, 3.9224330579013567`*^9}, {
  3.922433118237327*^9, 3.922433131328266*^9}, {3.930806545149982*^9, 
  3.9308065668972597`*^9}},ExpressionUUID->"febe9f20-4301-4ed9-9f9b-\
015b71d1265d"],

Cell[CellGroupData[{

Cell["Util setup", "Section",
 CellChangeTimes->{{3.7388680105176635`*^9, 
  3.738868012705719*^9}},ExpressionUUID->"f2a5b45b-3547-4440-ac6f-\
57f8ad416e95"],

Cell[CellGroupData[{

Cell["Clearing rogue symbols after aborting Module[] evaluation", "Subsection",
 CellChangeTimes->{{3.785223548983115*^9, 
  3.7852235717688704`*^9}},ExpressionUUID->"5ce74f07-28f1-4bef-8e14-\
3d494047e860"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lastModuleSymbols", "[", "]"}], ":=", 
  RowBox[{"Names", "[", 
   RowBox[{"\"\<*$\>\"", "<>", 
    RowBox[{"ToString", "[", "$ModuleNumber", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7852232986039553`*^9, 3.785223303684453*^9}},
 CellLabel->
  "In[1058]:=",ExpressionUUID->"5a764653-9306-4fa8-b4b8-e3316bcd94e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"clearLastModuleSymbols", "[", "]"}], ":=", 
  RowBox[{"Remove", "[", 
   RowBox[{"\"\<*$\>\"", "<>", 
    RowBox[{"ToString", "[", "$ModuleNumber", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785223199203554*^9, 3.7852232921245747`*^9}},
 CellLabel->
  "In[1059]:=",ExpressionUUID->"cfbabe94-afc7-4df4-959e-d6979425afcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cascading With[] (based on WithCascading by Leonid Shifrin)", \
"Subsection",
 CellChangeTimes->{{3.738868019643011*^9, 
  3.7388680897277603`*^9}},ExpressionUUID->"f97680cd-8d86-4fb1-b336-\
e7c895d8666e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "WithCascading", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"WithCascading", ",", "HoldAll"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "[", "WithCascading", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}], ",", 
     RowBox[{"\"\<LocalVariables\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Solve\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "}"}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"WithCascading", "/:", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"assign", ":", 
      RowBox[{"SetDelayed", "|", "RuleDelayed"}]}], ")"}], "[", 
    RowBox[{"lhs_", ",", 
     RowBox[{"rhs", ":", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"WithCascading", "[", 
        RowBox[{
         RowBox[{"{", "__", "}"}], ",", "_"}], "]"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "With", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Attributes", "[", "With", "]"}], "=", 
       RowBox[{"{", "HoldAll", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"assign", "[", 
       RowBox[{"lhs", ",", 
        RowBox[{"Evaluate", "[", "rhs", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WithCascading", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "expr_"}], "]"}], ":=", "expr"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WithCascading", "[", 
    RowBox[{
     RowBox[{"{", "head_", "}"}], ",", "expr_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "head", "}"}], ",", "expr"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WithCascading", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"head_", ",", "tail__"}], "}"}], ",", "expr_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "With", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Attributes", "[", "With", "]"}], "=", 
       RowBox[{"{", "HoldAll", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "head", "}"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"WithCascading", "[", 
          RowBox[{
           RowBox[{"{", "tail", "}"}], ",", "expr"}], "]"}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.738868064533312*^9, 3.7388680897121334`*^9}},
 CellLabel->
  "In[1060]:=",ExpressionUUID->"2a6bf6ba-651e-4cbc-8db1-da4af5c4076a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Option checker", "Subsection",
 CellChangeTimes->{{3.7388626639348536`*^9, 
  3.73886266981474*^9}},ExpressionUUID->"c45cf4e6-c5cf-4421-9ae4-\
ded6b5db0785"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"register", " ", "name", " ", "for", " ", "autocomlete"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"OptionValuePatterns", ";"}]}]], "Input",
 CellChangeTimes->{{3.7388645757226224`*^9, 3.7388645952371063`*^9}},
 CellLabel->
  "In[1067]:=",ExpressionUUID->"b04be7ec-88bf-4ebf-9b97-46f6ca50cc4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"checkOptions", ",", "HoldFirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"checkOptions", "[", 
   RowBox[{"call", ":", 
    RowBox[{"func_", "[", 
     RowBox[{"args__", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"bad", "=", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "opts", "}"}], ",", 
        RowBox[{"Except", "[", 
         RowBox[{"Options", "[", "func", "]"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "check", " ", "for", " ", "unknown", " ", "options", " ", "first"}], " ",
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "bad", "]"}], ">", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"func", "::", "optx"}], ",", 
         RowBox[{"First", "[", "bad", "]"}], ",", 
         RowBox[{"HoldForm", "[", "call", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "all", " ", "option", " ", "names", " ", "are", " ", "valid"}], ",", 
        " ", 
        RowBox[{
        "check", " ", "validity", " ", "of", " ", "values", " ", "next"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "@", 
          RowBox[{"OptionValuePatterns", "[", "func", "]"}]}], "===", 
         "OptionValuePatterns"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"no", " ", "patterns", " ", "are", " ", "defined"}], ",", 
          " ", 
          RowBox[{"return", " ", "valid"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "iterate", " ", "over", " ", "all", " ", "defined", " ", "option",
              " ", "value", " ", "patterns"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"badVal", "=", 
            RowBox[{"SelectFirst", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "opts", "}"}], ",", 
                RowBox[{"OptionValuePatterns", "[", "func", "]"}]}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                   RowBox[{"OptionValuePatterns", "[", "func", "]"}]}]}], 
                 "]"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MissingQ", "[", "badVal", "]"}], ",", 
            "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"func", "::", "optv"}], ",", "badVal", ",", 
               RowBox[{"HoldForm", "[", "call", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "False"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.738862670967089*^9, 3.738862712472724*^9}, {
   3.73886308031614*^9, 3.738863218963154*^9}, {3.738863396283269*^9, 
   3.7388634159084263`*^9}, {3.738863483900315*^9, 3.738863561131153*^9}, {
   3.738863613377719*^9, 3.738863633656541*^9}, {3.738863669252634*^9, 
   3.738863725846115*^9}, {3.7388637586911993`*^9, 3.7388637816746736`*^9}, {
   3.738863889784191*^9, 3.738863893133093*^9}, {3.7388639257226195`*^9, 
   3.7388639320164304`*^9}, {3.7388640120450993`*^9, 3.738864014502384*^9}, {
   3.7388640455736823`*^9, 3.738864046117131*^9}, {3.738864099361929*^9, 
   3.738864250596611*^9}, {3.738865325612582*^9, 3.738865327565688*^9}, 
   3.796805904412674*^9},
 CellLabel->
  "In[1068]:=",ExpressionUUID->"c6d544b2-4ff6-4563-9f33-9210590238d7"],

Cell[CellGroupData[{

Cell["Usage demonstration", "Subsubsection",
 CellChangeTimes->{{3.73886436833185*^9, 
  3.7388643742068152`*^9}},ExpressionUUID->"753a90d1-b710-40c6-a459-\
b7cb8a98dd79"],

Cell[BoxData[
 RowBox[{"ClearAll", "@", "func"}]], "Input",
 CellChangeTimes->{{3.738864341799409*^9, 3.738864346378682*^9}},
 CellLabel->
  "In[1070]:=",ExpressionUUID->"9521ea52-cd22-4e1a-9cb4-8b7472e6b213"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Options", "[", "func", "]"}], "=", 
  RowBox[{"{", 
   RowBox[{"\"\<a\>\"", "\[Rule]", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.738862918874092*^9, 3.738862942222752*^9}},
 CellLabel->
  "In[1071]:=",ExpressionUUID->"7b597c27-5f74-4684-977e-ac7ce541f777"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"a\"\>", "\[Rule]", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7388629395186186`*^9, 3.738862942441497*^9}, {
   3.738863010658627*^9, 3.7388630212364187`*^9}, 3.738863814371945*^9, 
   3.7388643477846336`*^9, 3.753377291608939*^9, 3.753684877080069*^9, 
   3.757763381485314*^9, 3.757766528126997*^9, 3.7580440807644577`*^9, 
   3.7619127598096657`*^9, 3.7663081888365*^9, 3.784985595259968*^9, 
   3.785506911251968*^9},
 CellLabel->
  "Out[1071]=",ExpressionUUID->"2e42dce8-58c4-4923-91cc-d55f2ce7a83f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OptionValuePatterns", "[", "func", "]"}], "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"\"\<a\>\"", "\[Rule]", 
    RowBox[{"_", "?", "NumericQ"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.7388628126896935`*^9, 3.738862883565542*^9}, 
   3.738863470377776*^9},
 CellLabel->
  "In[1072]:=",ExpressionUUID->"f60e6d79-2b0c-4952-9ec5-c5682e343c03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"a\"\>", "\[Rule]", 
   RowBox[{"_", "?", "NumericQ"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7388628859109287`*^9, {3.7388630110302205`*^9, 3.738863022014366*^9}, {
   3.738863785930275*^9, 3.738863814907099*^9}, 3.7388643488962107`*^9, 
   3.753377291664173*^9, 3.753684877117996*^9, 3.757763381517976*^9, 
   3.757766528160081*^9, 3.758044080802683*^9, 3.761912759845702*^9, 
   3.766308188893524*^9, 3.78498559526731*^9, 3.7855069112667522`*^9},
 CellLabel->
  "Out[1072]=",ExpressionUUID->"6989381c-3d38-4ffb-86c7-6143e908e4dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Head", "@", 
  RowBox[{"OptionValuePatterns", "[", "func", "]"}]}]], "Input",
 CellChangeTimes->{{3.738863900846211*^9, 3.738863921736449*^9}},
 CellLabel->
  "In[1073]:=",ExpressionUUID->"18a66252-3267-4293-a23a-348e31b670bf"],

Cell[BoxData["List"], "Output",
 CellChangeTimes->{{3.7388639192678423`*^9, 3.7388639219800224`*^9}, 
   3.738864349947919*^9, 3.753377291713209*^9, 3.753684877135954*^9, 
   3.757763381552034*^9, 3.757766528199407*^9, 3.758044080825399*^9, 
   3.76191275987894*^9, 3.766308188940139*^9, 3.784985595282509*^9, 
   3.785506911274707*^9},
 CellLabel->
  "Out[1073]=",ExpressionUUID->"82e0cd90-5ae0-4c27-a78f-ba697c0caa72"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"x_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "?", "checkOptions"}], ":=", 
  RowBox[{"x", "+", 
   RowBox[{"OptionValue", "[", "\"\<a\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7388628934873767`*^9, 3.7388629162989473`*^9}, {
  3.738862948597145*^9, 3.7388630183931804`*^9}, {3.7388638235344076`*^9, 
  3.7388638236906767`*^9}},
 CellLabel->
  "In[1074]:=",ExpressionUUID->"4d1038c7-f732-4833-9941-2b69643ce2eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{"1", ",", 
   RowBox[{"\"\<a\>\"", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellLabel->
  "In[1075]:=",ExpressionUUID->"98721d60-54b4-4737-936d-7dce379dfcc2"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.738864388799871*^9, 3.7533772917891483`*^9, 
  3.753684877205723*^9, 3.757763381592361*^9, 3.757766528250931*^9, 
  3.758044080885614*^9, 3.761912759921872*^9, 3.766308189038591*^9, 
  3.7849855953089952`*^9, 3.785506911304638*^9},
 CellLabel->
  "Out[1075]=",ExpressionUUID->"4c8c9e3a-c6f4-42e2-818c-c0ab45f756f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"func", "[", 
   RowBox[{"1", ",", 
    RowBox[{"\"\<b\>\"", "\[Rule]", "a"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.738862951914407*^9, 3.7388629540479984`*^9}, {
   3.7388630276580124`*^9, 3.738863031891198*^9}, {3.73886379533136*^9, 
   3.738863796654829*^9}, {3.7388642714813843`*^9, 3.7388642769317718`*^9}, 
   3.796805969845289*^9},ExpressionUUID->"c107a464-d136-4a1c-9e4b-\
933982dc0183"],

Cell[BoxData[
 TemplateBox[{
  "func", "optx", 
   "\"Unknown option \\!\\(\\*RowBox[{\\\"\\\\\\\"b\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"a\\\"}]\\) in \\!\\(\\*RowBox[{\\\"func\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", RowBox[{\\\"\\\\\\\"b\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"a\\\"}]}], \\\"]\\\"}]\\).\"", 2, 1076, 151, 
   17331194701362120536, "Local", "Global`func"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.7388642718251386`*^9, 3.7388642771163397`*^9}, 
   3.7388643516751604`*^9, 3.753377291837679*^9, 3.753684877228479*^9, 
   3.7577633816104794`*^9, 3.757766528324243*^9, 3.758044080929202*^9, 
   3.761912759970581*^9, 3.7663081891752663`*^9, 3.784985595320513*^9, 
   3.7855069113202143`*^9},
 CellLabel->
  "During evaluation of \
In[1076]:=",ExpressionUUID->"ea688293-fbbb-4c96-ae95-35d11ecfdf0d"],

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{"1", ",", 
   RowBox[{"\<\"b\"\>", "\[Rule]", "a"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7388629543935223`*^9, 3.738863032361801*^9}, {
   3.7388637913631973`*^9, 3.738863815932829*^9}, {3.7388642688158903`*^9, 
   3.7388642771476197`*^9}, 3.7388643516907763`*^9, 3.753377291850834*^9, 
   3.753684877234799*^9, 3.757763381617198*^9, 3.757766528331337*^9, 
   3.7580440809371357`*^9, 3.761912759978162*^9, 3.766308189184306*^9, 
   3.7849855953236227`*^9, 3.7855069113209352`*^9},
 CellLabel->
  "Out[1076]=",ExpressionUUID->"e21563b0-0c89-423a-93f4-c59539adc2a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"func", "[", 
   RowBox[{"1", ",", 
    RowBox[{"\"\<a\>\"", "\[Rule]", "b"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7388643820470877`*^9, 3.738864393298941*^9}, 
   3.796805972010953*^9},ExpressionUUID->"eeea0bc8-239a-493c-8328-\
2d794d66170a"],

Cell[BoxData[
 TemplateBox[{
  "func", "optv", 
   "\"Value of option \\!\\(\\*RowBox[{\\\"\\\\\\\"a\\\\\\\"\\\", \\\"\[Rule]\
\\\", \\\"b\\\"}]\\) in \\!\\(\\*RowBox[{\\\"func\\\", \\\"[\\\", \
RowBox[{\\\"1\\\", \\\",\\\", RowBox[{\\\"\\\\\\\"a\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"b\\\"}]}], \\\"]\\\"}]\\) is not valid.\"", 2, 1077, 152,
    17331194701362120536, "Local", "Global`func"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.738864393564577*^9, 3.753377291904195*^9, 
  3.7536848772522383`*^9, 3.75776338165068*^9, 3.757766528374778*^9, 
  3.758044080982996*^9, 3.761912760000861*^9, 3.766308189328684*^9, 
  3.784985595339834*^9, 3.785506911332941*^9},
 CellLabel->
  "During evaluation of \
In[1077]:=",ExpressionUUID->"347bc90a-ec9c-4e56-925e-2be290c5d692"],

Cell[BoxData[
 RowBox[{"func", "[", 
  RowBox[{"1", ",", 
   RowBox[{"\<\"a\"\>", "\[Rule]", "b"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.738864382831025*^9, 3.738864393564577*^9}, 
   3.753377291917602*^9, 3.753684877258938*^9, 3.757763381657756*^9, 
   3.757766528381854*^9, 3.758044080991889*^9, 3.7619127600087013`*^9, 
   3.7663081893383512`*^9, 3.7849855953405523`*^9, 3.7855069113337383`*^9},
 CellLabel->
  "Out[1077]=",ExpressionUUID->"37afb74b-6aaf-48af-ac38-10dc9576db64"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Continuation setup", "Section",
 CellChangeTimes->{{3.7388674730145397`*^9, 
  3.7388674765651207`*^9}},ExpressionUUID->"12a0097d-92fb-4dfb-bdd2-\
a1d4385dfd24"],

Cell[CellGroupData[{

Cell["Setup of ContinuationData[] object", "Subsection",
 CellChangeTimes->{{3.738862625830756*^9, 
  3.738862634423972*^9}},ExpressionUUID->"37666e59-2968-456e-889d-\
3b1ce2b0a2f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"continuationAssociationQ", "[", 
    RowBox[{"a_", "?", "AssociationQ"}], "]"}], ":=", 
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Eqs\>\"", ",", "\"\<Params\>\"", ",", "\"\<Vars\>\"", ",", 
       "\"\<CurveData\>\"", ",", "\"\<Rejects\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", 
       RowBox[{"a", ",", "#"}], "]"}], "&"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.738855642443615*^9, 3.738855687249415*^9}, {
  3.738855739381278*^9, 3.738855817124032*^9}, {3.7388608953341436`*^9, 
  3.738860898475171*^9}},
 CellLabel->
  "In[1078]:=",ExpressionUUID->"786a70ab-5f5e-4583-9f45-db636f4832d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "ContinuationData", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ContinuationData", "[", "asc_", "]"}], "[", "p_", "]"}], ":=", 
    RowBox[{"Lookup", "[", 
     RowBox[{"asc", ",", "p"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ContinuationData", "/:", 
   RowBox[{"MakeBoxes", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"obj", ":", 
      RowBox[{"ContinuationData", "[", 
       RowBox[{"asc_", "?", "continuationAssociationQ"}], "]"}]}], ",", 
     RowBox[{"form", ":", 
      RowBox[{"(", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"above", ",", "below"}], "}"}], ",", 
     RowBox[{
      RowBox[{"above", "=", 
       RowBox[{"{", 
        RowBox[{"(*", "grid", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Vars: \>\"", ",", 
              RowBox[{"asc", "[", "\"\<Vars\>\"", "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "SpanFromLeft"}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<NumPoints: \>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"asc", "[", "\"\<CurveData\>\"", "]"}]}]}], "}"}], 
            "]"}], ",", 
           RowBox[{"BoxForm`SummaryItem", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<NumRejects: \>\"", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"asc", "[", "\"\<Rejects\>\"", "]"}]}]}], "}"}], 
            "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"below", "=", 
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{"dropdown", " ", "column"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"BoxForm`SummaryItem", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Params: \>\"", ",", 
            RowBox[{"asc", "[", "\"\<Params\>\"", "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"BoxForm`SummaryItem", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Eqs: \>\"", ",", 
            RowBox[{"Short", "@", 
             RowBox[{"asc", "[", "\"\<Eqs\>\"", "]"}]}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BoxForm`ArrangeSummaryBox", "[", "\[IndentingNewLine]", 
       RowBox[{"ContinuationData", ",", " ", 
        RowBox[{"(*", "head", "*)"}], "\[IndentingNewLine]", "obj", ",", 
        RowBox[{"(*", "interpretation", "*)"}], "\[IndentingNewLine]", "None",
         ",", 
        RowBox[{"(*", "icon", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "above", " ", "and", " ", "below", " ", "must", " ", "be", " ", "in",
           " ", "a", " ", "format", " ", "suitable", " ", "for", " ", "Grid", 
          " ", "or", " ", "Column"}], "*)"}], "\[IndentingNewLine]", "above", 
        ",", 
        RowBox[{"(*", 
         RowBox[{"always", " ", "shown", " ", "content"}], "*)"}], 
        "\[IndentingNewLine]", "below", ",", 
        RowBox[{"(*", 
         RowBox[{"expandable", " ", "content"}], "*)"}], 
        "\[IndentingNewLine]", "form", ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Interpretable\>\"", "\[Rule]", "Automatic"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.73885557911487*^9, 3.738855634731511*^9}, {
  3.7388558263419895`*^9, 3.7388558358475327`*^9}, {3.7388558881303015`*^9, 
  3.7388561743174844`*^9}, {3.7388607009467487`*^9, 3.738860708818886*^9}, {
  3.738860917350857*^9, 3.7388609297639656`*^9}, {3.738860980284528*^9, 
  3.738860980931173*^9}, {3.738861319301382*^9, 3.7388613280454235`*^9}},
 CellLabel->
  "In[1079]:=",ExpressionUUID->"1260944e-89a5-4f06-b7f1-a388afe7bdff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ContinuationData", "[", "asc_", "]"}], "[", 
   RowBox[{"\"\<CurveData\>\"", "[", 
    RowBox[{"vars", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "_Symbol", ")"}], ".."}], "}"}]}], "]"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"varPos", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FirstPosition", "[", 
          RowBox[{
           RowBox[{"asc", "[", "\"\<Vars\>\"", "]"}], ",", "#"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "vars"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"asc", "[", "\"\<CurveData\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1", ",", "varPos"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7388613834650993`*^9, 3.738861579963153*^9}},
 CellLabel->
  "In[1082]:=",ExpressionUUID->"2827f5ca-f146-4018-9817-7b39e9912cc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Continuation function", "Subsection",
 CellChangeTimes->{{3.7388626458819847`*^9, 3.7388626595769606`*^9}, {
  3.738865422996853*^9, 
  3.7388654241807404`*^9}},ExpressionUUID->"926e2c79-2b9e-4bf9-95bd-\
6cba5725c45f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varQ", "[", "v_", "]"}], ":=", 
  RowBox[{"MatchQ", "[", 
   RowBox[{"v", ",", 
    RowBox[{"_Symbol", "|", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_", "?", "varQ"}], ")"}], "[", "_", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7389239279318285`*^9, 3.738924047580865*^9}},
 CellLabel->
  "In[1083]:=",ExpressionUUID->"395e9039-c600-435e-a1ef-a51f4dfa5c1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "@", "arclengthContinuation"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "arclengthContinuation", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<MinStepSize\>\"", "\[Rule]", 
       RowBox[{"10", "^", 
        RowBox[{"-", "4"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<MaxStepSize\>\"", "\[Rule]", "1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<MaxSteps\>\"", "\[Rule]", "1000"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TargetNewtonStepCount\>\"", "\[Rule]", "5"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TangentAlignmentThreshold\>\"", "\[Rule]", "0.8"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ParamDomain\>\"", "\[Rule]", "All"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TerminateAtFold\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TerminateAtRoot\>\"", "\[Rule]", "None"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<StepSizeGoals\>\"", "\[Rule]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PrecisionGoal", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "\[Rule]", "Automatic"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OptionValuePatterns", "[", "arclengthContinuation", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<MinStepSize\>\"", "\[Rule]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
           RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<MaxStepSize\>\"", "\[Rule]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
           RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<MaxSteps\>\"", "\[Rule]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
           RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TargetNewtonSetpCount\>\"", "\[Rule]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
           RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TangentAlignmentThreshold\>\"", "\[Rule]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"NumericQ", "[", "#", "]"}], "&&", 
           RowBox[{"0", "<", "#", "<", "1"}]}], "&"}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ParamDomain\>\"", "\[Rule]", 
       RowBox[{"All", "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], ",", 
          RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<StepSizeGoals\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"_", "?", "varQ"}], "\[Rule]", 
           RowBox[{"_", "?", "NumericQ"}]}], ")"}], "..."}], "}"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arclengthContinuation", "::", "badexpr"}], "=", 
   "\"\<Expression `1` in `2` should evaluate to a number.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arclengthContinuation", "::", "badvar"}], "=", 
   "\"\<Unkown variable `1` in `2`.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arclengthContinuation", "::", "minstep"}], "=", 
   "\"\<Minimal stepsize `1` reached at iteration `2`, vars = `3`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"arclengthContinuation", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs_", "?", "VectorQ"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"residue", " ", "function"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"params", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"_", "?", "varQ"}], "\[Rule]", 
          RowBox[{"_", "?", "NumberQ"}]}], ")"}], ".."}], "}"}]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"parameters", " ", "as", " ", "list", " ", "of", " ", "rules"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"initSol", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"_", "?", "varQ"}], "\[Rule]", 
          RowBox[{"_", "?", "NumberQ"}]}], ")"}], ".."}], "}"}]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
      "starting", " ", "solution", " ", "for", " ", "the", " ", 
       "continuation"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Mu]_", "?", "varQ"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"the", " ", "\"\<active\>\"", " ", "parameter"}], " ", "*)"}], 
     "\[IndentingNewLine]", "initStep_", ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"initial", " ", "step", " ", "size", " ", 
        RowBox[{"(", 
         RowBox[{
         "the", " ", "sign", " ", "determines", " ", "the", " ", "direction", 
          "\[IndentingNewLine]", "of", " ", "the", " ", "continuation"}], 
         ")"}]}], ",", " ", 
       RowBox[{
       "the", " ", "algorithm", " ", "will", " ", "autmatically", " ", 
        "adopt", " ", "this", " ", "along", " ", "\[IndentingNewLine]", "the",
         " ", "continuation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
   "?", "checkOptions"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", " ", 
      RowBox[{"static", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"minStepSize", "=", 
       RowBox[{"OptionValue", "[", "\"\<MinStepSize\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxStepSize", "=", 
       RowBox[{"OptionValue", "[", "\"\<MaxStepSize\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"maxSteps", "=", 
       RowBox[{"OptionValue", "[", "\"\<MaxSteps\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"targetNSC", "=", 
       RowBox[{"OptionValue", "[", "\"\<TargetNewtonStepCount\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"activeParamDomain", "=", 
       RowBox[{"Sort", "@", 
        RowBox[{"OptionValue", "[", "\"\<ParamDomain\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"tangentAlignmentThreshold", "=", 
       RowBox[{
       "OptionValue", "[", "\"\<TangentAlignmentThreshold\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"terminateAtFold", "=", 
       RowBox[{"OptionValue", "[", "\"\<TerminateAtFold\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vars", "=", 
         RowBox[{"initSol", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "varsExt", ",", 
        "fixedParams", ",", "eqsNumerical", ",", "\[IndentingNewLine]", "ds", 
        ",", "prevSol", ",", "ns", ",", 
        RowBox[{"(*", 
         RowBox[{"prevTan", ","}], "*)"}], "newTan", ",", "tan", ",", "pre", 
        ",", "sol", ",", "reject", ",", "numSteps", ",", 
        "\[IndentingNewLine]", "reaped", ",", "\[IndentingNewLine]", 
        RowBox[{"hitDomainBoundary", "=", "False"}], ",", "\[Mu]0", ",", 
        "\[Mu]1", ",", "\[Mu]b", ",", "term0", ",", "term1", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "options", " ", "*)"}], "\[IndentingNewLine]", 
        "stepSizeGoals", ",", "\[IndentingNewLine]", 
        RowBox[{"tol", "=", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}], ",", 
        RowBox[{"terminator", "=", "None"}], ",", "\[IndentingNewLine]", 
        RowBox[{"terminationReason", "=", "None"}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<TerminateAtRoot\>\"", "]"}], ",", 
         "\[IndentingNewLine]", "None", ",", 
         RowBox[{"terminator", "=", "None"}], ",", "\[IndentingNewLine]", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"NumberQ", "[", 
             RowBox[{
              RowBox[{"#", "/.", "params"}], "/.", "initSol"}], "]"}], "&"}], 
           ")"}]}], ",", 
         RowBox[{"terminator", "=", 
          RowBox[{"OptionValue", "[", "\"\<TerminateAtRoot\>\"", "]"}]}], ",",
          "\[IndentingNewLine]", "_", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"arclengthContinuation", "::", "badexpr"}], ",", 
            RowBox[{"OptionValue", "[", "\"\<TerminateAtRoot\>\"", "]"}], 
            ",", "\"\<Option 'TerminateAtRoot'\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"fixedParams", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"params", ",", 
          RowBox[{"\[Mu]", "\[Rule]", "_"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"varsExt", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"vars", ",", 
          RowBox[{"{", "\[Mu]", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"badVars", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<StepSizeGoals\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "varsExt"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "badVars"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"arclengthContinuation", "::", "badvar"}], ",", 
              "badVars", ",", 
              RowBox[{"\"\<Option StepSizeGoals\>\"", "\[Rule]", 
               RowBox[{"OptionValue", "[", "\"\<StepSizeGoals\>\"", "]"}]}]}],
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"stepSizeGoals", "=", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"FirstPosition", "[", 
               RowBox[{"varsExt", ",", 
                RowBox[{"First", "@", "#"}]}], "]"}]}], ",", 
             RowBox[{"Last", "@", "#"}]}], "}"}], "&"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<StepSizeGoals\>\"", "]"}], ",", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"varsExt", ",", 
               RowBox[{"First", "@", "#"}]}], "]"}], "&"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"eqsNumerical", "=", 
        RowBox[{
        "Experimental`CreateNumericalFunction", "[", "\[IndentingNewLine]", 
         RowBox[{"varsExt", ",", "\[IndentingNewLine]", 
          RowBox[{"eqs", "/.", "fixedParams"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Length", "@", "eqs"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"terminator", "=", 
        RowBox[{"terminator", "/.", "fixedParams"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"prevSol", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"varsExt", "/.", "params"}], "/.", "initSol"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"eqsNumerical", "@", "prevSol"}], "]"}], ",", "tol"}], 
           "]"}], "=!=", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Initial solution not valid!\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ns", "=", 
        RowBox[{"NullSpace", "[", 
         RowBox[{"Re", "@", 
          RowBox[{"eqsNumerical", "[", 
           RowBox[{"\"\<Jacobian\>\"", "[", "prevSol", "]"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "@", "ns"}], "===", "NullSpace"}], "||", 
          RowBox[{
           RowBox[{"Length", "@", "ns"}], "\[Equal]", "0"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No tangent vector found.\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "$Failed", "]"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tan", "=", 
           RowBox[{"Last", "@", "ns"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "ensure", " ", "that", " ", "the", " ", "initial", " ", "tangent", 
         " ", "points", " ", "in", " ", "the", " ", "right", " ", 
         "direction"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"initStep", " ", 
           RowBox[{"tan", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "<", "0"}], ",", 
         RowBox[{"tan", "=", 
          RowBox[{"-", "tan"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ds", "=", 
        RowBox[{"initStep", "/", 
         RowBox[{"tan", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"minStepSize", "/=", 
          RowBox[{"Abs", "@", 
           RowBox[{"prevTan", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"reaped", "=", 
        RowBox[{"Last", "@", 
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sow", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "prevSol", ",", "prevSol", ",", "ns", ",", "prevSol", ",", "0", 
               ",", "ds", ",", "0"}], "}"}], ",", "\"\<accepted\>\""}], "]"}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ds", "<", "minStepSize"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{
                   RowBox[{"arclengthContinuation", "::", "minstep"}], ",", 
                   "minStepSize", ",", "itCount", ",", "prevSol"}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"terminationReason", "=", "\"\<MinStep\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "restrict", " ", "arclength", " ", "step", " ", "size", " ", 
                "to", " ", "meet", " ", "step", " ", "size", " ", "goals"}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ds", " ", 
                    RowBox[{"tan", "[", 
                    RowBox[{"[", 
                    RowBox[{"goal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ">", 
                   RowBox[{"goal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ds", "=", 
                   RowBox[{
                    RowBox[{"goal", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", 
                    RowBox[{"tan", "[", 
                    RowBox[{"[", 
                    RowBox[{"goal", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"goal", ",", "stepSizeGoals"}], "}"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "linearly", " ", "predict", " ", "the", " ", "next", " ", 
                "location"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pre", "=", 
               RowBox[{"prevSol", "+", 
                RowBox[{"ds", " ", "tan"}]}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "correct", " ", "the", " ", "prediction", " ", 
                "perpendicularly", " ", "to", " ", "the", " ", "tangent"}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"numSteps", "=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"reject", "=", "False"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Quiet", "@", 
               RowBox[{"Check", "[", 
                RowBox[{
                 RowBox[{"sol", "=", 
                  RowBox[{
                   RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Re", "@", 
                    RowBox[{"eqsNumerical", "[", "x", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "pre"}], ")"}], ".", "tan"}]}], " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "correction", " ", "perpendicular", " ", "to", " ", 
                    RowBox[{"tangent", "!"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "pre"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Evaluated", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StepMonitor", "\[RuleDelayed]", 
                    RowBox[{"numSteps", "++"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "PrecisionGoal", "]"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"AccuracyGoal", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"reject", "=", "True"}]}], "\[IndentingNewLine]", 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"reject", "\[Equal]", "False"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"calculate", " ", "tangent"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ns", "=", 
                  RowBox[{"NullSpace", "[", 
                   RowBox[{"Re", "@", 
                    RowBox[{"eqsNumerical", "[", 
                    RowBox[{"\"\<Jacobian\>\"", "[", "sol", "]"}], "]"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "@", "ns"}], "===", "NullSpace"}], "||", 
                    RowBox[{
                    RowBox[{"Length", "@", "ns"}], "\[Equal]", "0"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    "Print", "[", "\"\<No tangent vector found.\>\"", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"terminationReason", "=", "\"\<TangentFail\>\""}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "if", " ", "there", " ", "are", " ", "multiple", " ", 
                    "nullspace", " ", "directions"}], ",", " ", 
                   RowBox[{"fall", " ", "back", " ", "to", " ", "secant"}]}], 
                  " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", "ns"}], ">", "1"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"newTan", "=", 
                    RowBox[{"Normalize", "[", 
                    RowBox[{"sol", "-", "prevSol"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"newTan", "=", 
                    RowBox[{"First", "@", "ns"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "check", " ", "if", " ", "the", " ", "solution", " ", 
                   "tangent", " ", "is", " ", "sufficiently", " ", 
                   "aligned"}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"newTan", ".", "tan"}], "]"}], "<", 
                    "tangentAlignmentThreshold"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"reject", "=", "True"}]}], "\[IndentingNewLine]", 
                  "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"make", " ", "sure", " ", "we", " ", 
                   RowBox[{"don", "'"}], "t", " ", "change", " ", "direction",
                    " ", "along", " ", "the", " ", "path"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"newTan", ".", "tan"}], "<", "0"}], ",", 
                   RowBox[{"newTan", "=", 
                    RowBox[{"-", "newTan"}]}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"reject", "\[Equal]", "True"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"reject", " ", "step"}], ",", " ", 
                  RowBox[{"reduce", " ", "step", " ", "size"}]}], " ", "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sow", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "sol", ",", "prevSol", ",", "ns", ",", "pre", ",", 
                    "numSteps", ",", "ds", ",", "itCount"}], "}"}], ",", 
                   "\"\<rejected\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"ds", "/=", "2."}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{"===", "===", "==="}], "=", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"accept", " ", "step"}], " ", "===", "===", "==="}],
                  "="}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "terminate", " ", "at", " ", "fold", " ", "if", " ", 
                "requested"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"OptionValue", "[", "\"\<TerminateAtFold\>\"", "]"}],
                  "===", "True"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"tan", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], 
                    RowBox[{"Sign", "[", " ", 
                    RowBox[{"newTan", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "<", "0"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "sol", ",", "prevSol", ",", "ns", ",", "pre", ",", 
                    "numSteps", ",", "ds", ",", "itCount"}], "}"}], ",", 
                    "\"\<accepted\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"terminationReason", "=", "\"\<Fold\>\""}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"tan", "=", "newTan"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "is", " ", "there", " ", "a", " ", "parameter", " ", "domain", 
                " ", 
                RowBox[{"restriction", "?"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"activeParamDomain", "=!=", "All"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"yes", " ", "\[Rule]", " ", 
                  RowBox[{
                  "check", " ", "if", " ", "parameter", " ", "domain", " ", 
                   "was", " ", "left"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Mu]1", "=", 
                  RowBox[{"sol", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"\[Mu]1", "<", 
                    RowBox[{"First", "@", "activeParamDomain"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\[Mu]b", "=", 
                    RowBox[{"First", "@", "activeParamDomain"}]}], ";", 
                    RowBox[{"hitDomainBoundary", "=", "True"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"\[Mu]1", ">", 
                    RowBox[{"Last", "@", "activeParamDomain"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\[Mu]b", "=", 
                    RowBox[{"Last", "@", "activeParamDomain"}]}], ";", 
                    RowBox[{"hitDomainBoundary", "=", "True"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{"hitDomainBoundary", ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "find", " ", "solution", " ", "at", " ", "the", " ", 
                    "domain", " ", "boundary"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\[Mu]0", "=", 
                    RowBox[{"prevSol", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Check", "[", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "catch", " ", "division", " ", "by", " ", "zero"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pre", "=", 
                    RowBox[{"prevSol", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Mu]b", "-", "\[Mu]0"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"\[Mu]1", "-", "\[Mu]0"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"sol", "-", "prevSol"}], ")"}]}]}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"ZERO", " ", 
                    RowBox[{"DIV", ":", " ", 
                    RowBox[{
                    "simply", " ", "append", " ", "current", " ", "solution", 
                    " ", "and", " ", "break", " ", "immediately"}]}]}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "sol", ",", "prevSol", ",", "ns", ",", "pre", ",", 
                    "numSteps", ",", "ds", ",", "itCount"}], "}"}], ",", 
                    "\"\<accepted\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    StyleBox[
                    RowBox[{"Power", "::", "infy"}], "MessageName"]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"sol", "=", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Re", "@", 
                    RowBox[{"eqsNumerical", "@", "x"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", "\[Mu]b"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "pre"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Evaluated", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PrecisionGoal", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "PrecisionGoal", "]"}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"AccuracyGoal", "\[Rule]", 
                    RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "sol", ",", "prevSol", ",", "ns", ",", "pre", ",", 
                    "numSteps", ",", "ds", ",", "itCount"}], "}"}], ",", 
                    "\"\<accepted\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    "terminationReason", "=", "\"\<DomainBoundary\>\""}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"is", " ", "there", " ", "a", " ", "termination", " ", 
                RowBox[{"condition", "?"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"terminator", "=!=", "None"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"function", " ", "terminator"}], " ", "\[Rule]", 
                  " ", 
                  RowBox[{
                  "check", " ", "for", " ", "sign", " ", "change", " ", "of", 
                   " ", "the", " ", "terminator", " ", "fucntion"}]}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"term0", "=", 
                  RowBox[{"(", 
                   RowBox[{"terminator", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsExt", "\[Rule]", "prevSol"}], "]"}]}], 
                   ")"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"term1", "=", 
                  RowBox[{"(", 
                   RowBox[{"terminator", "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"varsExt", "\[Rule]", "sol"}], "]"}]}], ")"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"term0", " ", "term1"}], "<", "0"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "interpolate", " ", "to", " ", "get", " ", "the", " ", 
                    "solution", " ", "at", " ", "the", " ", "terminator", " ",
                     "root"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pre", "=", 
                    RowBox[{"Check", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"prevSol", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"0", "-", "term0"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"term1", "-", "term0"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"sol", "-", "prevSol"}], ")"}]}]}], ",", 
                    "\[IndentingNewLine]", "sol", ",", "\[IndentingNewLine]", 
                    StyleBox[
                    RowBox[{"Power", "::", "infy"}], "MessageName"]}], 
                    "\[IndentingNewLine]", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "sol", ",", "prevSol", ",", "ns", ",", "pre", ",", 
                    "numSteps", ",", "ds", ",", "itCount"}], "}"}], ",", 
                    "\"\<accepted\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    "terminationReason", "=", "\"\<TerminatorRoot\>\""}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Sow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "sol", ",", "prevSol", ",", "ns", ",", "pre", ",", 
                  "numSteps", ",", "ds", ",", "itCount"}], "}"}], ",", 
                "\"\<accepted\>\""}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"adapt", " ", "step", " ", "size"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"numSteps", ">", 
                 RowBox[{"1.3", "targetNSC"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"ds", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{"ds", " ", 
                   RowBox[{"targetNSC", "/", "numSteps"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"numSteps", "<", 
                   RowBox[{"0.7", "targetNSC"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ds", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"Min", "[", 
                    RowBox[{"maxStepSize", ",", 
                    RowBox[{"ds", " ", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"targetNSC", "/", "numSteps"}], ",", "2"}], 
                    "]"}]}]}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"proceed", " ", "to", " ", "next", " ", "iteration"}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"prevSol", "=", "sol"}], ";"}], "\[IndentingNewLine]", 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"itCount", ",", "maxSteps"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"terminationReason", "===", "None"}], ",", 
         RowBox[{"terminationReason", "=", "\"\<MaxSteps\>\""}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"ContinuationData", "[", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<Eqs\>\"", "\[Rule]", "eqs"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Params\>\"", "\[Rule]", "fixedParams"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Vars\>\"", "\[Rule]", "varsExt"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<CurveData\>\"", "\[Rule]", 
           RowBox[{"First", "@", "reaped"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Rejects\>\"", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "reaped"}], "\[Equal]", "1"}], ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"reaped", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "\"\<TerminationReason\>\"", "\[Rule]", "terminationReason"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<EqsNumerical\>\"", "\[Rule]", "eqsNumerical"}]}], 
         "\[IndentingNewLine]", "|>"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6616664246326*^9, 3.661666431910948*^9}, {
   3.661666470232061*^9, 3.661666482232312*^9}, {3.6616665486902323`*^9, 
   3.661666553562105*^9}, {3.661667641255659*^9, 3.661667738743456*^9}, {
   3.6616677820807543`*^9, 3.661667805689332*^9}, {3.661667857370494*^9, 
   3.6616680269135647`*^9}, {3.6616682003031054`*^9, 
   3.6616682102370777`*^9}, {3.6616682402883673`*^9, 
   3.6616682535286217`*^9}, {3.661668308451619*^9, 3.661668385669909*^9}, {
   3.661668417665344*^9, 3.661668428712419*^9}, {3.661668483897769*^9, 
   3.661668509803459*^9}, {3.66166860688734*^9, 3.661668658656478*^9}, {
   3.661668722067926*^9, 3.661668758228435*^9}, {3.6616687921817417`*^9, 
   3.661668817774626*^9}, {3.661668879412201*^9, 3.6616690681127567`*^9}, {
   3.661669190014104*^9, 3.6616691901174917`*^9}, {3.661669258056946*^9, 
   3.661669336371464*^9}, {3.661669409006781*^9, 3.661669606028944*^9}, {
   3.661669662278535*^9, 3.661669713281329*^9}, 3.661669824110818*^9, {
   3.661670063094983*^9, 3.66167006479126*^9}, {3.66167015689046*^9, 
   3.66167016343468*^9}, {3.661670731336244*^9, 3.66167075475349*^9}, {
   3.661670792474959*^9, 3.661670881422772*^9}, {3.661670923263542*^9, 
   3.66167093515989*^9}, 3.6616710243884983`*^9, {3.661671214971616*^9, 
   3.661671233506866*^9}, {3.661671776694811*^9, 3.661671778550846*^9}, {
   3.6616718218721447`*^9, 3.661671825936523*^9}, {3.6616718657223177`*^9, 
   3.661671884042588*^9}, {3.661671925900181*^9, 3.661672013536446*^9}, {
   3.661672073346447*^9, 3.66167209237062*^9}, {3.661672601191555*^9, 
   3.661672666457397*^9}, {3.66167278643012*^9, 3.661672939294999*^9}, {
   3.661673008287507*^9, 3.661673106091755*^9}, {3.66167313811664*^9, 
   3.661673183230761*^9}, {3.661673231904457*^9, 3.661673302242358*^9}, {
   3.661673365588139*^9, 3.661673426351083*^9}, 3.661673565372637*^9, {
   3.6616773493669853`*^9, 3.661677362479393*^9}, {3.6616774079524117`*^9, 
   3.661677408873487*^9}, {3.661678002863727*^9, 3.661678095841179*^9}, {
   3.66167812849219*^9, 3.66167840612339*^9}, {3.661678599372558*^9, 
   3.661678695844016*^9}, {3.6616787309246187`*^9, 3.661678754391199*^9}, {
   3.661678784927355*^9, 3.661678826878749*^9}, {3.66167887977701*^9, 
   3.661678885843959*^9}, {3.6616789203551683`*^9, 3.661679049913518*^9}, {
   3.661679109368992*^9, 3.661679144697391*^9}, {3.661679240398703*^9, 
   3.661679337351409*^9}, {3.6616794027382507`*^9, 3.661679478467876*^9}, {
   3.661679743435542*^9, 3.661679802571394*^9}, {3.66167985464578*^9, 
   3.661680027067093*^9}, {3.6616803501777573`*^9, 3.661680407463097*^9}, {
   3.66168049869151*^9, 3.661680500956086*^9}, {3.661680541210513*^9, 
   3.661680596133471*^9}, {3.661680635367782*^9, 3.661680679961512*^9}, 
   3.66168073361138*^9, {3.661680778269424*^9, 3.661680947305745*^9}, {
   3.661681002352566*^9, 3.6616810550120897`*^9}, {3.6616811025678787`*^9, 
   3.6616812494837933`*^9}, {3.661681360434271*^9, 3.6616813605431623`*^9}, {
   3.661681399409629*^9, 3.661681418875197*^9}, {3.661681460662348*^9, 
   3.661681469670082*^9}, {3.661681593746449*^9, 3.661681688237892*^9}, {
   3.6616817244543467`*^9, 3.6616818122893133`*^9}, {3.661681842649597*^9, 
   3.661681917927544*^9}, {3.661682035965036*^9, 3.661682037114963*^9}, {
   3.661682610062564*^9, 3.661682612782278*^9}, {3.661682666801148*^9, 
   3.661682736880309*^9}, {3.661682808335973*^9, 3.661683058469903*^9}, {
   3.661683114135971*^9, 3.661683248089869*^9}, {3.661683338164545*^9, 
   3.661683353511772*^9}, {3.661683430617416*^9, 3.661683580157427*^9}, {
   3.66168361665458*^9, 3.661683631863693*^9}, {3.661683669927477*^9, 
   3.661683826764701*^9}, {3.661683877502933*^9, 3.661683877886942*^9}, {
   3.6616841055676947`*^9, 3.661684120229102*^9}, {3.661684379477604*^9, 
   3.6616844036465054`*^9}, {3.661685336197608*^9, 3.6616853389600077`*^9}, {
   3.661686206358371*^9, 3.661686239857148*^9}, {3.661687763531048*^9, 
   3.661687793633267*^9}, 3.6719568974968276`*^9, {3.674629013227416*^9, 
   3.674629136295871*^9}, {3.6755079528767815`*^9, 3.675507980949374*^9}, {
   3.67550802116555*^9, 3.6755080632557993`*^9}, {3.6755081486154485`*^9, 
   3.6755081524438744`*^9}, {3.675508208022217*^9, 3.6755082220075502`*^9}, 
   3.675508257246833*^9, {3.675508290537819*^9, 3.675508325583997*^9}, {
   3.675508413920113*^9, 3.6755085032524257`*^9}, 3.675509048872757*^9, {
   3.6755158347590694`*^9, 3.6755158390192757`*^9}, {3.675515902056641*^9, 
   3.675515906332406*^9}, {3.6755160027041206`*^9, 3.675516003221324*^9}, {
   3.675571014830085*^9, 3.6755711659908733`*^9}, {3.6755713185808344`*^9, 
   3.6755713574878597`*^9}, {3.675571490885256*^9, 3.6755714994786277`*^9}, {
   3.6755721360451956`*^9, 3.6755722344293976`*^9}, {3.6755723016978188`*^9, 
   3.675572336224098*^9}, {3.675572672405958*^9, 3.6755727342017164`*^9}, {
   3.6755729365867496`*^9, 3.6755730908032894`*^9}, {3.675573141650651*^9, 
   3.675573263892334*^9}, {3.675573312738293*^9, 3.6755733308006973`*^9}, {
   3.675573435233479*^9, 3.6755734574512815`*^9}, {3.6755737134348946`*^9, 
   3.6755737274268703`*^9}, {3.675573950622197*^9, 3.6755739870737677`*^9}, {
   3.675574073223897*^9, 3.6755741185542297`*^9}, {3.675574192890931*^9, 
   3.6755742332606144`*^9}, {3.6755742695198927`*^9, 
   3.6755742710096893`*^9}, {3.675574351389487*^9, 3.67557435435847*^9}, {
   3.675579912783499*^9, 3.6755799555531855`*^9}, {3.6755800146909485`*^9, 
   3.6755800200773077`*^9}, {3.6755801760404544`*^9, 3.675580189055085*^9}, {
   3.6755802964636326`*^9, 3.6755803933800325`*^9}, 3.6755804638336844`*^9, {
   3.6755805597437057`*^9, 3.67558059362052*^9}, 3.675581067918744*^9, {
   3.676102278324869*^9, 3.676102293843589*^9}, {3.676102328756468*^9, 
   3.6761023420037394`*^9}, {3.676102379125526*^9, 3.676102555532488*^9}, {
   3.676102758921523*^9, 3.67610279639107*^9}, {3.676102876206049*^9, 
   3.676102881622242*^9}, {3.7388507819676003`*^9, 3.738850831723707*^9}, {
   3.738850876660836*^9, 3.7388508863497686`*^9}, {3.7388509269627905`*^9, 
   3.7388509526621656`*^9}, {3.73885107334188*^9, 3.7388515386626024`*^9}, {
   3.7388515821459846`*^9, 3.7388515840939035`*^9}, {3.738851614774685*^9, 
   3.738851729380952*^9}, {3.738851806129285*^9, 3.7388518288910747`*^9}, {
   3.738851964848775*^9, 3.7388519951713967`*^9}, {3.7388521036188087`*^9, 
   3.7388522062006745`*^9}, {3.7388522683024254`*^9, 3.7388523113806*^9}, {
   3.738861036147809*^9, 3.738861089414988*^9}, {3.7388611198359776`*^9, 
   3.738861254077207*^9}, {3.738864537503013*^9, 3.7388645453155117`*^9}, {
   3.738864613674883*^9, 3.738864825644107*^9}, {3.738864868238224*^9, 
   3.7388650199326496`*^9}, {3.7388650809191217`*^9, 
   3.7388651109566927`*^9}, {3.7388652272522173`*^9, 
   3.7388652402370977`*^9}, {3.738865392100839*^9, 3.73886539483071*^9}, {
   3.738868919888568*^9, 3.7388689706590443`*^9}, {3.738870849362981*^9, 
   3.7388708553377657`*^9}, {3.7388708862529745`*^9, 3.73887088856482*^9}, {
   3.738870948129275*^9, 3.7388709819823027`*^9}, {3.738923794798993*^9, 
   3.738923795892867*^9}, {3.7389238893942747`*^9, 3.7389239117677317`*^9}, {
   3.7389241093615117`*^9, 3.7389241779507246`*^9}, {3.7389242921048203`*^9, 
   3.7389243008620434`*^9}, {3.738924590563101*^9, 3.7389246501898165`*^9}, {
   3.73892472728401*^9, 3.7389248688162737`*^9}, {3.7389249224714313`*^9, 
   3.7389250592059145`*^9}, {3.738925115596099*^9, 3.738925261524389*^9}, {
   3.7389253377054157`*^9, 3.738925524332139*^9}, 3.7389255876270776`*^9, {
   3.7389256222834654`*^9, 3.73892564687716*^9}, {3.7389257027058725`*^9, 
   3.738925887299075*^9}, {3.7390208599818187`*^9, 3.7390208600842433`*^9}, {
   3.7390232686874495`*^9, 3.7390233077269225`*^9}, {3.7390255774085803`*^9, 
   3.739025665434287*^9}, {3.739025696721357*^9, 3.7390257277716637`*^9}, {
   3.7390259299270167`*^9, 3.7390259521353636`*^9}, {3.7390260590535355`*^9, 
   3.7390261227133074`*^9}, {3.739027387073349*^9, 3.7390273908567333`*^9}, {
   3.7390274626901455`*^9, 3.739027467221202*^9}, {3.7390275173309145`*^9, 
   3.7390275363929296`*^9}, {3.739027765954338*^9, 3.7390277661511765`*^9}, {
   3.7390280338459377`*^9, 3.7390280339507275`*^9}, {3.7390280898617816`*^9, 
   3.7390281295811453`*^9}, {3.739028215595847*^9, 3.739028328330648*^9}, {
   3.739029612362893*^9, 3.7390296270199375`*^9}, {3.7390296888466663`*^9, 
   3.739029880564898*^9}, {3.7390347941161795`*^9, 3.739034799597209*^9}, {
   3.739034900627942*^9, 3.7390349061668625`*^9}, {3.7390352261358457`*^9, 
   3.7390352396585617`*^9}, 3.7390352920574455`*^9, {3.7533787489688263`*^9, 
   3.753378755932508*^9}, {3.784989551637129*^9, 3.784989595601245*^9}, {
   3.785076406593196*^9, 3.785076507897376*^9}, {3.785076604412675*^9, 
   3.785076647505124*^9}, {3.785076702752287*^9, 3.78507679166372*^9}, {
   3.785077104604245*^9, 3.785077133917432*^9}, {3.7850772184080057`*^9, 
   3.7850772320783863`*^9}, {3.785077305994586*^9, 3.785077324129446*^9}, {
   3.785077447648964*^9, 3.785077499671014*^9}, {3.785077538322658*^9, 
   3.785077594582992*^9}, {3.7850780406792793`*^9, 3.7850780460156527`*^9}, {
   3.7850784928101797`*^9, 3.785078517929523*^9}, {3.7850786635729113`*^9, 
   3.785078663857483*^9}, 3.785078701927371*^9, {3.785078804619364*^9, 
   3.785078805897031*^9}, 3.785079012082004*^9, {3.785079176755074*^9, 
   3.785079371205577*^9}, {3.7967956471703997`*^9, 3.7967956586932163`*^9}, {
   3.7967961933349953`*^9, 3.796796317610529*^9}, {3.796796470058981*^9, 
   3.796796470486027*^9}, {3.796796517327729*^9, 3.796796524413474*^9}, {
   3.796796608758341*^9, 3.7967966568729143`*^9}, {3.796796709148641*^9, 
   3.7967967466072607`*^9}, {3.796796776659857*^9, 3.796796912433917*^9}, {
   3.7967970181731577`*^9, 3.796797039986648*^9}, {3.796805685613752*^9, 
   3.7968056864508133`*^9}},ExpressionUUID->"7ade6f41-a6de-4dcf-9f0a-\
2a39e083a83c"],

Cell[CellGroupData[{

Cell["Bidirectional continuation", "Subsubsection",
 CellChangeTimes->{{3.7388654332931356`*^9, 
  3.7388654369081974`*^9}},ExpressionUUID->"dd8e1fd5-b422-4017-8efb-\
f2ecdc413952"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "arcContBidirectional", "]"}], "=", 
   RowBox[{"Options", "[", "arclengthContinuation", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arcContBidirectional", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqs_", "?", "VectorQ"}], ",", "\[IndentingNewLine]", 
    RowBox[{"params", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "\[Rule]", 
         RowBox[{"_", "?", "NumberQ"}]}], ")"}], ".."}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"initSol", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_", "\[Rule]", 
         RowBox[{"_", "?", "NumberQ"}]}], ")"}], ".."}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Mu]", ":", 
     RowBox[{"(", 
      RowBox[{"_Symbol", "|", 
       RowBox[{"_Symbol", "[", "_", "]"}]}], ")"}]}], ",", 
    "\[IndentingNewLine]", "initStep_", ",", "\[IndentingNewLine]", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fwCont", "=", 
       RowBox[{"Check", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"arclengthContinuation", "[", 
          RowBox[{
          "eqs", ",", "params", ",", "initSol", ",", "\[Mu]", ",", "initStep",
            ",", "opts"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"$Failed", ",", "With"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"bwCont", "=", 
       RowBox[{"Check", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"arclengthContinuation", "[", 
          RowBox[{"eqs", ",", "params", ",", "initSol", ",", "\[Mu]", ",", 
           RowBox[{"-", "initStep"}], ",", "opts"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"$Failed", ",", "With"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fwCont", "===", "$Failed"}], "||", 
       RowBox[{"bwCont", "===", "$Failed"}]}], ",", "\[IndentingNewLine]", 
      "$Failed", ",", "\[IndentingNewLine]", 
      RowBox[{"ContinuationData", "[", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<Eqs\>\"", "\[Rule]", "eqs"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Params\>\"", "\[Rule]", 
          RowBox[{"fwCont", "[", "\"\<Params\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Vars\>\"", "\[Rule]", 
          RowBox[{"fwCont", "[", "\"\<Vars\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<CurveData\>\"", "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Reverse", "[", 
             RowBox[{"bwCont", "[", "\"\<CurveData\>\"", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"fwCont", "[", "\"\<CurveData\>\"", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Rejects\>\"", "\[Rule]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Reverse", "[", 
             RowBox[{"bwCont", "[", "\"\<Rejects\>\"", "]"}], "]"}], ",", 
            RowBox[{"fwCont", "[", "\"\<Rejects\>\"", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<EqsNumerical\>\"", "\[Rule]", 
          RowBox[{"fwCont", "[", "\"\<EqsNumerical\>\"", "]"}]}]}], 
        "\[IndentingNewLine]", "|>"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7388655220777063`*^9, 3.738865566628235*^9}, {
  3.738866771062422*^9, 3.7388671542052417`*^9}},
 CellLabel->
  "In[1092]:=",ExpressionUUID->"4d116b4b-a368-46b9-b80d-8ee25edced74"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interploate on continuation curve", "Subsection",
 CellChangeTimes->{{3.738867219345786*^9, 
  3.7388672378161106`*^9}},ExpressionUUID->"2aef32a3-7084-46bf-a6af-\
e5d6f5a1cea3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "@", "interpolateAt"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interpolateAt", "::", "range"}], "=", 
   "\"\<Value `2` of range `3` of variable `1` \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "interpolateAt", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Corrector\>\"", "\[Rule]", "None"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"interpolateAt", "[", 
   RowBox[{
    RowBox[{"ContinuationData", "[", 
     RowBox[{"data_", "?", "AssociationQ"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"var_Symbol", ",", 
      RowBox[{"val_", "?", "NumericQ"}]}], "}"}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"WithCascading", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"varPos", "=", 
       RowBox[{
        RowBox[{"FirstPosition", "[", 
         RowBox[{
          RowBox[{"data", "[", "\"\<Vars\>\"", "]"}], ",", "var"}], "]"}], 
        "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"valList", "=", 
       RowBox[{
        RowBox[{"data", "[", "\"\<CurveData\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "varPos"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"valRange", "=", 
       RowBox[{"MinMax", "@", "valList"}]}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"val", "<", 
         RowBox[{"valRange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "||", 
        RowBox[{"val", ">", 
         RowBox[{"valRange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"interpolateAt", "::", "range"}], ",", "var", ",", "val", 
          ",", "valRange"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"linearInterpolates", "=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"brackets", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Times", "@@", 
                 RowBox[{"Transpose", "@", 
                  RowBox[{"Partition", "[", 
                   RowBox[{
                    RowBox[{"Sign", "[", 
                    RowBox[{"valList", "-", "val"}], "]"}], ",", "2", ",", 
                    "1"}], "]"}]}]}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"hits", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"valList", ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{"val", "-", "#"}], "]"}], "\[Equal]", "0"}], 
                   "&"}], ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "brackets"}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "$Failed", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "hits", "]"}], "\[Equal]", "0"}], 
                   ",", 
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{
                    RowBox[{"data", "[", "\"\<CurveData\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"First", "/@", "hits"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p0", "=", 
                    RowBox[{
                    RowBox[{"data", "[", "\"\<CurveData\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"b", ",", "1"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"p1", "=", 
                    RowBox[{
                    RowBox[{"data", "[", "\"\<CurveData\>\"", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"b", "+", "1"}], ",", "1"}], "]"}], "]"}]}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"p0", "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"val", "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "varPos", "]"}], "]"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p1", "[", 
                    RowBox[{"[", "varPos", "]"}], "]"}], "-", 
                    RowBox[{"p0", "[", 
                    RowBox[{"[", "varPos", "]"}], "]"}]}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"p1", "-", "p0"}], ")"}]}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"First", "/@", "brackets"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}], ",", "First"}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Corrector\>\"", "]"}], "=!=", 
          "None"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"data", "[", "\"\<Vars\>\"", "]"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"x", "/.", 
               RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Re", "@", 
                    RowBox[{
                    RowBox[{"data", "[", "\"\<EqsNumerical\>\"", "]"}], "[", 
                    "x", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "varPos", "]"}], "]"}], "-", "val"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "#"}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Evaluated", "\[Rule]", "False"}]}], 
                "\[IndentingNewLine]", "]"}]}], ")"}]}], "]"}], "&"}], "/@", 
          "linearInterpolates"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"data", "[", "\"\<Vars\>\"", "]"}], "\[Rule]", "#"}], 
            "]"}], "&"}], "/@", "linearInterpolates"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7388672414239616`*^9, 3.7388673328476505`*^9}, {
   3.7388673885541973`*^9, 3.738867439330894*^9}, {3.738867487839305*^9, 
   3.7388676873932486`*^9}, {3.73886774669557*^9, 3.738867762115119*^9}, {
   3.738868100130232*^9, 3.7388681477526083`*^9}, {3.7388682259514084`*^9, 
   3.7388682279122734`*^9}, {3.7388683065994744`*^9, 3.738868395060458*^9}, {
   3.7388684428385677`*^9, 3.738868613691154*^9}, {3.7388686673627734`*^9, 
   3.738868827596086*^9}, {3.738869014595992*^9, 3.7388692044710417`*^9}, {
   3.738869247284664*^9, 3.7388692484403133`*^9}, {3.738869287922437*^9, 
   3.738869315814927*^9}, {3.738869356706685*^9, 3.738869442720873*^9}, {
   3.73886947558185*^9, 3.7388694976427126`*^9}, 3.738869669799917*^9, {
   3.738869777347348*^9, 3.7388697962994986`*^9}, {3.738869840534562*^9, 
   3.738869897982057*^9}, 3.7388699534406695`*^9, {3.7388700284866915`*^9, 
   3.7388701051904573`*^9}, {3.739030844068933*^9, 3.739030848549239*^9}, {
   3.739031838120615*^9, 3.7390318728301992`*^9}, {3.7390319138882203`*^9, 
   3.739032117472644*^9}, {3.739032147983098*^9, 3.739032306432991*^9}, {
   3.7390323657635827`*^9, 3.739032475082776*^9}, {3.7390325664847803`*^9, 
   3.73903256664105*^9}, {3.739032600644211*^9, 3.739032674679427*^9}, {
   3.739032714028733*^9, 3.739032828534238*^9}},
 CellLabel->
  "In[1094]:=",ExpressionUUID->"b7b06b43-a538-4c11-bf99-fb755e002dda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting", "Subsection",
 CellChangeTimes->{{3.785172581048192*^9, 
  3.785172583057111*^9}},ExpressionUUID->"779a3889-a747-4a46-9dc4-\
04e13cfb8008"],

Cell[BoxData[
 RowBox[{
  RowBox[{"interactiveBfcPlot", "[", 
   RowBox[{"data_", ",", "bfcFunc_", ",", "profileFunc_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"bfcPlot", "=", 
      RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"bfcFunc", "@", "#"}]}], "}"}], "&"}], "/@", "data"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Column", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{"bfcPlot", ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AbsolutePointSize", "[", "5", "]"}], ",", "Red", ",", 
              RowBox[{"Point", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"bfcFunc", "@", "#"}]}], "}"}], "&"}], "@", 
                RowBox[{"data", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"profileFunc", "@", 
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "1"}], "}"}], ",", "1", ",", 
        RowBox[{"Length", "@", "data"}], ",", "1"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.785172393231584*^9, 3.785172498905733*^9}},
 CellLabel->
  "In[1098]:=",ExpressionUUID->"8971798c-35c5-4791-8f53-a7b405458ce9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inspection tools", "Subsection",
 CellChangeTimes->{{3.7390300174556103`*^9, 
  3.7390300217067847`*^9}},ExpressionUUID->"8df0139d-b0c2-4e0f-8901-\
d9784407eb62"],

Cell[CellGroupData[{

Cell["Plot tangent (null space) vectors ", "Subsubsection",
 CellChangeTimes->{{3.739030035284855*^9, 
  3.7390300604725857`*^9}},ExpressionUUID->"4692c8dd-e00d-45a3-920e-\
501afa98ff29"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", "=", 
      RowBox[{"contData", "[", "\"\<CurveData\>\"", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Point", "[", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}], "+", 
             RowBox[{"1000", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "3", ",", "1", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], 
               "]"}]}]}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}], "*)"}]], "Input",
 CellChangeTimes->{3.7390300279198947`*^9, 3.744284826689158*^9},
 CellLabel->
  "In[1099]:=",ExpressionUUID->"cae2f362-71df-425e-92f1-50891abb4693"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1091, 778},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"PTMono14.nb",
ExpressionUUID->"60b0c328-30a7-4bdc-8fe0-224ff0a3d51d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1293, 27, 743, "Text",ExpressionUUID->"60f7483d-969d-4f48-aa14-760057194c1e"],
Cell[1854, 49, 446, 8, 122, "Text",ExpressionUUID->"febe9f20-4301-4ed9-9f9b-015b71d1265d"],
Cell[CellGroupData[{
Cell[2325, 61, 157, 3, 101, "Section",ExpressionUUID->"f2a5b45b-3547-4440-ac6f-57f8ad416e95"],
Cell[CellGroupData[{
Cell[2507, 68, 207, 3, 81, "Subsection",ExpressionUUID->"5ce74f07-28f1-4bef-8e14-3d494047e860"],
Cell[2717, 73, 356, 8, 46, "Input",ExpressionUUID->"5a764653-9306-4fa8-b4b8-e3316bcd94e9"],
Cell[3076, 83, 362, 8, 46, "Input",ExpressionUUID->"cfbabe94-afc7-4df4-959e-d6979425afcc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3475, 96, 211, 4, 81, "Subsection",ExpressionUUID->"f97680cd-8d86-4fb1-b336-e7c895d8666e"],
Cell[3689, 102, 2648, 79, 420, "Input",ExpressionUUID->"2a6bf6ba-651e-4cbc-8db1-da4af5c4076a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6374, 186, 163, 3, 81, "Subsection",ExpressionUUID->"c45cf4e6-c5cf-4421-9ae4-ded6b5db0785"],
Cell[6540, 191, 362, 8, 55, "Input",ExpressionUUID->"b04be7ec-88bf-4ebf-9b97-46f6ca50cc4c"],
Cell[6905, 201, 4732, 109, 627, "Input",ExpressionUUID->"c6d544b2-4ff6-4563-9f33-9210590238d7"],
Cell[CellGroupData[{
Cell[11662, 314, 171, 3, 45, "Subsubsection",ExpressionUUID->"753a90d1-b710-40c6-a459-b7cb8a98dd79"],
Cell[11836, 319, 209, 4, 32, "Input",ExpressionUUID->"9521ea52-cd22-4e1a-9cb4-8b7472e6b213"],
Cell[CellGroupData[{
Cell[12070, 327, 297, 7, 32, "Input",ExpressionUUID->"7b597c27-5f74-4684-977e-ac7ce541f777"],
Cell[12370, 336, 553, 10, 36, "Output",ExpressionUUID->"2e42dce8-58c4-4923-91cc-d55f2ce7a83f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12960, 351, 415, 9, 77, "Input",ExpressionUUID->"f60e6d79-2b0c-4952-9ec5-c5682e343c03"],
Cell[13378, 362, 582, 11, 36, "Output",ExpressionUUID->"6989381c-3d38-4ffb-86c7-6143e908e4dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13997, 378, 251, 5, 32, "Input",ExpressionUUID->"18a66252-3267-4293-a23a-348e31b670bf"],
Cell[14251, 385, 420, 7, 36, "Output",ExpressionUUID->"82e0cd90-5ae0-4c27-a78f-ba697c0caa72"]
}, Open  ]],
Cell[14686, 395, 509, 12, 32, "Input",ExpressionUUID->"4d1038c7-f732-4833-9941-2b69643ce2eb"],
Cell[CellGroupData[{
Cell[15220, 411, 202, 5, 32, "Input",ExpressionUUID->"98721d60-54b4-4737-936d-7dce379dfcc2"],
Cell[15425, 418, 365, 6, 36, "Output",ExpressionUUID->"4c8c9e3a-c6f4-42e2-818c-c0ab45f756f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15827, 429, 447, 9, 32, "Input",ExpressionUUID->"c107a464-d136-4a1c-9e4b-933982dc0183"],
Cell[16277, 440, 840, 16, 24, "Message",ExpressionUUID->"ea688293-fbbb-4c96-ae95-35d11ecfdf0d"],
Cell[17120, 458, 617, 11, 36, "Output",ExpressionUUID->"e21563b0-0c89-423a-93f4-c59539adc2a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17774, 474, 296, 7, 32, "Input",ExpressionUUID->"eeea0bc8-239a-493c-8328-2d794d66170a"],
Cell[18073, 483, 790, 15, 24, "Message",ExpressionUUID->"347bc90a-ec9c-4e56-925e-2be290c5d692"],
Cell[18866, 500, 487, 9, 36, "Output",ExpressionUUID->"37afb74b-6aaf-48af-ac38-10dc9576db64"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19426, 517, 167, 3, 67, "Section",ExpressionUUID->"12a0097d-92fb-4dfb-bdd2-a1d4385dfd24"],
Cell[CellGroupData[{
Cell[19618, 524, 182, 3, 54, "Subsection",ExpressionUUID->"37666e59-2968-456e-889d-3b1ce2b0a2f3"],
Cell[19803, 529, 776, 20, 77, "Input",ExpressionUUID->"786a70ab-5f5e-4583-9f45-db636f4832d2"],
Cell[20582, 551, 4343, 98, 695, "Input",ExpressionUUID->"1260944e-89a5-4f06-b7f1-a388afe7bdff"],
Cell[24928, 651, 1041, 28, 121, "Input",ExpressionUUID->"2827f5ca-f146-4018-9817-7b39e9912cc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26006, 684, 224, 4, 54, "Subsection",ExpressionUUID->"926e2c79-2b9e-4bf9-95bd-6cba5725c45f"],
Cell[26233, 690, 415, 12, 33, "Input",ExpressionUUID->"395e9039-c600-435e-a1ef-a51f4dfa5c1e"],
Cell[26651, 704, 51316, 1040, 5865, "Input",ExpressionUUID->"7ade6f41-a6de-4dcf-9f0a-2a39e083a83c"],
Cell[CellGroupData[{
Cell[77992, 1748, 181, 3, 45, "Subsubsection",ExpressionUUID->"dd8e1fd5-b422-4017-8efb-f2ecdc413952"],
Cell[78176, 1753, 4116, 97, 673, "Input",ExpressionUUID->"4d116b4b-a368-46b9-b80d-8ee25edced74"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82341, 1856, 183, 3, 54, "Subsection",ExpressionUUID->"2aef32a3-7084-46bf-a6af-e5d6f5a1cea3"],
Cell[82527, 1861, 9421, 214, 979, "Input",ExpressionUUID->"b7b06b43-a538-4c11-bf99-fb755e002dda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91985, 2080, 156, 3, 54, "Subsection",ExpressionUUID->"779a3889-a747-4a46-9dc4-04e13cfb8008"],
Cell[92144, 2085, 2615, 62, 407, "Input",ExpressionUUID->"8971798c-35c5-4791-8f53-a7b405458ce9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94796, 2152, 168, 3, 54, "Subsection",ExpressionUUID->"8df0139d-b0c2-4e0f-8901-d9784407eb62"],
Cell[CellGroupData[{
Cell[94989, 2159, 187, 3, 45, "Subsubsection",ExpressionUUID->"4692c8dd-e00d-45a3-920e-501afa98ff29"],
Cell[95179, 2164, 1964, 51, 209, "Input",ExpressionUUID->"cae2f362-71df-425e-92f1-50891abb4693"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

